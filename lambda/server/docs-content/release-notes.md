# MarginArc Release Notes

**Product:** MarginArc -- AI Margin Intelligence for IT VARs
**Maintained by:** MarginArc Product Team
**Last Updated:** February 2026

---

## Conventions

This document follows [Semantic Versioning](https://semver.org/) (MAJOR.MINOR.PATCH):

- **MAJOR** version increments indicate breaking changes or significant architectural shifts.
- **MINOR** version increments indicate new features or substantial enhancements that are
  backward-compatible.
- **PATCH** version increments indicate bug fixes, security patches, and minor improvements.

Each release is organized into the following categories:

- **Added:** New features and capabilities.
- **Changed:** Modifications to existing features.
- **Fixed:** Bug fixes.
- **Security:** Security improvements and vulnerability patches.
- **Deprecated:** Features that will be removed in a future release.
- **Removed:** Features that have been removed.
- **Known Limitations:** Documented constraints and issues.

---

## Version 1.0.0 --- Initial Release

**Release Date:** February 2026
**Salesforce API Version:** 62.0
**Backend Runtime:** Node.js 18 on AWS Lambda
**LWC Framework:** Lightning Web Components (current)
**CI/CD:** GitHub Actions (auto-deploy on push to master)

### Overview

Version 1.0.0 is the initial release of MarginArc, an AI-powered margin intelligence
platform purpose-built for IT Value-Added Resellers (VARs). This release delivers a
complete Salesforce-native experience for margin optimization, including real-time deal
scoring, margin recommendations, win probability estimation, competitive intelligence,
AI-generated explanations, and anonymized network benchmarking.

The platform embeds directly within the Salesforce Opportunity record as a set of Lightning
Web Components, providing sales representatives with actionable intelligence without
leaving their existing workflow.

---

### Added

#### MarginArc Margin Advisor (Primary LWC)

The Margin Advisor is the primary intelligence component, displayed on the Opportunity
record page. It delivers the following capabilities:

- **Deal Score (0-100):** A composite score reflecting the overall health and pricing
  position of the deal, computed from 31 signals across 6 categories. Scores are
  color-coded: green (70-100, well-positioned), amber (40-69, review recommended), red
  (0-39, high risk).

- **Recommended Margin:** An AI-generated margin recommendation based on deal parameters,
  OEM benchmarks, competitive landscape, and network intelligence. The recommendation is
  displayed alongside the representative's planned margin for direct comparison.

- **Win Probability:** A logistic model estimate of the deal's probability of closing at the
  planned margin. The model uses the formula `1/(1+exp(0.08*(marginPct-18)))`, where higher
  margins correspond to lower win probabilities, reflecting the empirical trade-off between
  margin and win rate.

- **Plan vs. Recommendation Comparison:** A side-by-side view showing the representative's
  planned margin against MarginArc's recommendation, with delta calculation and visual
  indicators for alignment or divergence.

- **Key Drivers:** A ranked list of the most influential factors driving the recommendation,
  drawn from the 31-signal architecture. Drivers are displayed as human-readable labels
  (e.g., "Competitive pressure from Arista detected," "Services attachment increases margin
  ceiling," "Incumbent position supports premium pricing").

- **AI Analysis:** A natural-language explanation generated by Google Gemini that synthesizes
  the quantitative recommendation into an actionable narrative. The explanation addresses
  the "why" behind the recommendation in language accessible to non-technical sales
  professionals.

- **One-Click Apply Recommendation:** A button that writes the recommended margin, deal
  score, win probability, and AI analysis back to the Opportunity's MarginArc custom fields,
  eliminating manual data entry.

#### Deal Insights (LWC)

The Deal Insights component provides contextual intelligence for the deal's primary OEM:

- **OEM-specific tips:** Curated guidance for 10 major OEMs (Cisco, Dell, HPE, Lenovo,
  Microsoft, Palo Alto Networks, Aruba/HPE, Fortinet, VMware, NetApp), covering
  vendor-specific margin optimization strategies, program incentives, and common pitfalls.

- **Contextual relevance:** Tips are filtered based on the deal's product category, size,
  and competitive landscape to ensure relevance.

- **Expandable detail:** Each tip includes a summary and an expandable detail section for
  representatives who want deeper context.

#### What-If Scenario Builder (LWC)

The Scenario Builder enables sales representatives to model pricing scenarios before
committing to a margin:

- **Interactive margin adjustment:** Slider and input controls allow the representative to
  explore different margin levels and instantly see the impact on deal score and win
  probability.

- **Side-by-side comparison:** Multiple scenarios can be compared against the current plan
  and MarginArc's recommendation.

- **Sensitivity analysis:** Visual indicators show how sensitive the deal score and win
  probability are to margin changes, helping representatives understand the risk/reward
  trade-off.

#### Competitive Intelligence (LWC)

The Competitive Intelligence component provides head-to-head analysis when competitors are
identified on the deal:

- **Head-to-head records:** Historical win/loss data against named competitors in the
  relevant product category and deal size range.

- **Competitive margin benchmarks:** Anonymized margin ranges observed in competitive
  situations (subject to differential privacy and k-anonymity protections).

- **Strategic recommendations:** Context-specific guidance on positioning against identified
  competitors.

#### 31-Signal Architecture

The MarginArc intelligence engine evaluates 31 signals organized across 6 categories:

| Category        | Signal Count | Examples                                                          |
| --------------- | ------------ | ----------------------------------------------------------------- |
| Deal Attributes | 8            | Deal size, contract duration, services attachment, renewal status |
| OEM/Vendor      | 5            | OEM identity, product category, vendor program tier               |
| Competitive     | 5            | Competitor presence, incumbent status, number of competitors      |
| Timing          | 4            | Deal stage, days to close, quarter-end proximity                  |
| Historical      | 5            | Account history, segment win rate, margin trend                   |
| Network         | 4            | Peer benchmark, market position, segment demand                   |

Each signal contributes a weighted score to the composite Deal Score. Signal weights are
determined by the intelligence engine's model parameters, which are updated through
federated learning.

#### 4-Phase Intelligence Maturity Model

MarginArc implements a progressive intelligence maturity model that delivers increasing value
as the platform accumulates data and network participation grows:

1. **SignalLayer (Available at install):** Rule-based recommendations using OEM benchmarks
   and deal attribute analysis. Requires no historical data. Provides immediate value from
   day one.

2. **MatchIQ (Available with deal history):** Pattern matching against the customer's own
   historical deals. Identifies similar past deals and their outcomes to inform
   recommendations. Activates as the organization's MarginArc dataset grows.

3. **PricePoint (Available with network participation):** Peer benchmarking using anonymized
   data from the MarginArc Network. Provides market-level intelligence on competitive pricing.
   Requires network opt-in and minimum participant thresholds.

4. **AdaptIQ (Continuous improvement):** Federated learning enables the model to improve
   continuously as new deal outcomes are recorded across the network. The global model
   becomes more accurate over time without any single organization sharing raw data.

#### MarginArc Network

- **Federated learning:** Local model training with encrypted gradient sharing. Raw deal
  data never leaves the customer's Salesforce org.

- **Differential privacy:** Laplace noise injection (epsilon=1.0) on all network queries.
  Every aggregate statistic is mathematically guaranteed to protect individual contributions.

- **Conflict firewall:** SHA-256 hashing prevents organizations from seeing their own data
  reflected in network benchmarks.

- **k-Anonymity:** All network aggregations require a minimum of 5 contributing
  organizations before returning results.

#### AI-Powered Explanations

- **Google Gemini integration:** Natural-language explanations generated via the Gemini API,
  providing human-readable narratives for quantitative recommendations.

- **Contextual prompts:** The Gemini prompt is constructed from the deal parameters and
  recommendation output, ensuring the explanation is specific to the deal.

- **No data retention:** Gemini API calls are stateless. No deal data is retained by Google
  per the API data processing terms.

#### One-Click Apply Recommendation

- **Field write-back:** Clicking "Apply Recommendation" writes the following fields to the
  Opportunity: `Fulcrum_Recommended_Margin__c`, `Fulcrum_Deal_Score__c`,
  `Fulcrum_Win_Probability__c`, `Fulcrum_AI_Analysis__c`, `Fulcrum_Last_Analysis_Date__c`,
  `Fulcrum_Key_Drivers__c`, `Fulcrum_Confidence_Level__c`, and `Fulcrum_Risk_Level__c`.

- **Audit trail:** The `Fulcrum_Last_Analysis_Date__c` field records when the recommendation
  was applied, providing an audit trail for management review.

#### Fallback Mock Mode

- **Offline/demo capability:** When the MarginArc API is unreachable or returns an error, the
  LWC components fall back to a local mock model that generates representative (but clearly
  marked as simulated) recommendations.

- **Demo support:** The mock mode enables sales demonstrations and proof-of-concept
  evaluations without requiring a live API connection.

- **Graceful degradation:** Users are notified when mock mode is active. The interface
  clearly distinguishes between live and simulated recommendations.

#### CI/CD Pipeline

- **GitHub Actions:** Automated build, test, and deployment pipeline triggered on push to
  the master branch.

- **Automated Lambda deployment:** The pipeline packages the Node.js backend and deploys
  it to AWS Lambda using the AWS CLI.

- **Salesforce deployment:** The pipeline deploys LWC and Apex components to the target
  Salesforce org using the Salesforce CLI (`sf`).

- **Secret management:** AWS credentials, Salesforce auth tokens, and API keys are stored
  in GitHub Actions encrypted secrets.

---

### Salesforce Package Contents

| Component Type              | Count | Components                                                                                |
| --------------------------- | ----- | ----------------------------------------------------------------------------------------- |
| Lightning Web Components    | 7     | `fulcrumMarginAdvisor`, `fulcrumBomTable`, `fulcrumDealInsights`, `fulcrumWhatIf`, `fulcrumCompetitiveIntel`, `fulcrumManagerDashboard`, `fulcrumPoolConfig` |
| Apex Controllers            | 4     | `FulcrumController`, `FulcrumCompetitiveController`, `FulcrumManagerController`, `FulcrumBatchAnalyzer` |
| Apex Test Classes           | 4     | `FulcrumControllerTest` (9), `FulcrumCompetitiveControllerTest` (8), `FulcrumManagerControllerTest` (10), `FulcrumBatchAnalyzerTest` (16) — 43 total |
| Custom Fields (Opportunity) | 22    | All prefixed `Fulcrum_` (see CLAUDE.md for full list)                                     |
| Custom Objects              | 2     | `Fulcrum_OEM__c`, `Fulcrum_Competitor__c`                                                 |
| Custom Tabs                 | 1     | `Fulcrum_Manager_Dashboard`                                                               |
| Remote Site Settings        | 2     | MarginArc API (`api.marginarc.com`), Gemini API (`generativelanguage.googleapis.com`)    |

---

### Known Limitations

The following limitations are documented for the 1.0.0 release. Each is tracked for
resolution in a future release.

1. **~~No Apex test classes~~ (RESOLVED):** 4 Apex test classes now exist with 43 total test
   methods: `FulcrumControllerTest` (9), `FulcrumCompetitiveControllerTest` (8),
   `FulcrumManagerControllerTest` (10), `FulcrumBatchAnalyzerTest` (16). All tests pass
   and are run automatically via CI/CD on every deployment.

2. **Gemini API key in Apex controller:** The Google Gemini API key is currently stored
   directly in the Apex controller source code. This is a security concern because the key
   is visible to anyone with access to the Apex source in the org. Version 1.1.0 will move
   the API key to a Custom Metadata Type, which provides proper access control and
   encryption.

3. **~~Single-deal analysis only~~ (RESOLVED):** `FulcrumBatchAnalyzer` now provides nightly
   batch analysis of all open Opportunities via a Salesforce Scheduled Batch job (2 AM).
   Incremental mode (Mon-Sat) analyzes unscored deals; full refresh (Sunday) re-analyzes all
   open deals. On-demand backfill available via `Database.executeBatch(new FulcrumBatchAnalyzer(true), 10)`.

4. **Network participant minimum:** The MarginArc Network requires a minimum of 5 participating
   organizations to return meaningful peer benchmarks. In market segments with fewer than 5
   participants, network intelligence is unavailable, and recommendations rely solely on
   local models and static benchmarks.

5. **Single currency:** The current release assumes a single currency (USD). Multi-currency
   support is planned for version 1.2.0.

6. **Desktop layout only:** The LWC layout is optimized for desktop Salesforce. The mobile
   Salesforce app is not fully supported in this release. Mobile-optimized layouts are
   planned for version 1.2.0.

7. **English language only:** All UI text, AI explanations, and documentation are in English.
   Localization is not yet supported.

8. **10 OEMs supported:** Deal Insights contextual tips are available for 10 OEMs. Additional
   OEM coverage will be added in future releases based on customer demand.

---

### Supported Platforms

**Salesforce:**

- Sales Cloud (any edition with API access)
- Salesforce API version 62.0
- Lightning Experience (Classic is not supported)
- Editions: Enterprise, Unlimited, Developer, Performance

**Browsers:**

- Google Chrome (latest two major versions)
- Mozilla Firefox (latest two major versions)
- Apple Safari (latest two major versions)
- Microsoft Edge (latest two major versions)

**Installation Prerequisites:**

- Salesforce org with API access enabled
- System Administrator profile for installation
- Permission to create CSP Trusted Sites and Remote Site Settings
- Network access to the MarginArc API domain (api.marginarc.com)

**Installation:**
Refer to the Implementation Guide (`implementation-guide.md`) for step-by-step installation
instructions.

---

---

## Planned: Version 1.1.0

**Target Release:** Q2 2026
**Theme:** Production Readiness and Operational Excellence

### Planned Features

#### ~~Apex Test Classes~~ (DELIVERED in 1.0.0)

- Delivered in 1.0.0: 4 test classes, 43 methods, covering all controllers and the batch analyzer.

#### Custom Metadata Type for API Key Storage

- Migration of the Gemini API key from hardcoded Apex to a Custom Metadata Type
  (`Fulcrum_Config__mdt`).
- MarginArc API endpoint URL also moved to Custom Metadata for easier configuration.
- Administrators can update API keys without modifying Apex source code.
- Custom Metadata records are deployable via change sets and metadata API.

#### Enhanced Error Handling and Retry Logic

- Automatic retry with exponential backoff for transient API failures.
- User-friendly error messages replacing technical error details.
- Structured error logging to `Fulcrum_Analysis_Log__c` for troubleshooting.
- Circuit breaker pattern: after repeated failures, the system switches to local-only
  mode and notifies the administrator.

#### ~~Batch Recommendation Mode~~ (DELIVERED in 1.0.0)

- Delivered in 1.0.0: `FulcrumBatchAnalyzer` — nightly scheduled batch job analyzing all open deals.

#### ~~Dashboard Components for Management Reporting~~ (DELIVERED in 1.0.0)

- Delivered in 1.0.0: `fulcrumManagerDashboard` LWC — standalone Lightning Tab with KPI strip,
  pipeline health table (filter pills + pagination), rep performance, margin opportunity,
  competitive performance, and summary alert bar.

---

## Planned: Version 1.2.0

**Target Release:** Q3 2026
**Theme:** Enterprise Features and Scale

### Planned Features

#### AppExchange Managed Package

- Conversion from unmanaged components to a Salesforce managed package.
- Namespace registration and component namespacing.
- Salesforce Security Review completion.
- AppExchange listing with pricing tiers.
- Managed package upgrade path for existing customers.

#### Multi-Currency Support

- Automatic currency detection from the Opportunity's `CurrencyIsoCode` field.
- Conversion to a common analysis currency for model processing.
- Display of recommendations in the deal's original currency.
- Support for dated exchange rates (Salesforce Advanced Currency Management).

#### Advanced Reporting Dashboards

- Pre-built Lightning Dashboard: "MarginArc Margin Intelligence Overview."
- Charts: Margin distribution by OEM, Deal Score distribution, Win Probability calibration,
  Recommendation adoption trend.
- Drill-down from dashboard to individual Opportunity records.
- Scheduled dashboard refresh and email delivery.

#### Slack Integration for Deal Alerts

- Slack app for MarginArc deal notifications.
- Configurable alerts: "Deal score below threshold," "Margin significantly below
  recommendation," "High-value deal detected."
- Rich message formatting with Deal Score, recommendation summary, and direct link to
  Salesforce Opportunity.
- Channel-based routing: alerts routed to team channels based on OEM, deal size, or owner.

#### Mobile-Optimized Layout

- Responsive LWC layout for the Salesforce mobile app.
- Condensed Margin Advisor view optimized for smaller screens.
- Swipe-based navigation between MarginArc components.
- Push notification support for deal alerts (via Slack integration).

---

## Planned: Version 2.0.0

**Target Release:** Q1 2027
**Theme:** Revenue Intelligence Platform

### Planned Features

#### Deal Approval Workflows

- Configurable approval workflows triggered by margin thresholds.
- Integration with Salesforce Approval Processes.
- Automatic routing: deals below recommended margin require manager approval.
- Approval history tracked on the Opportunity record.
- Escalation paths for high-value or high-risk deals.

#### Revenue Intelligence Module

- Pipeline-level margin analysis: aggregate margin forecast across the pipeline.
- Margin-at-risk identification: deals with high margin erosion probability.
- Revenue impact modeling: projected revenue impact of margin optimization.
- Trend analysis: margin trends by OEM, product category, team, and time period.

#### Forecast Impact Analysis

- Integration with Salesforce Forecasting.
- MarginArc-adjusted forecast: pipeline value weighted by win probability and recommended
  margin.
- Scenario modeling: "What if all reps adopted MarginArc recommendations?"
- Forecast accuracy tracking: compare MarginArc-adjusted forecasts against actual outcomes.

#### Partner Portal for Network Administration

- Web-based administration portal for MarginArc Network management.
- Organization enrollment, opt-in/opt-out management, and participation monitoring.
- Network health dashboard: participant count by segment, data freshness, model performance.
- Privacy settings: per-organization epsilon budget configuration (within allowed range).

#### Advanced Admin Configuration UI

- Custom Settings page within Salesforce Setup for MarginArc configuration.
- Configurable signal weights: administrators can adjust the influence of individual signals
  on the Deal Score.
- Custom OEM benchmark overrides: administrators can supplement MarginArc benchmarks with
  organization-specific targets.
- Role-based visibility rules: configure which MarginArc components and fields are visible to
  different user roles.
- Audit dashboard: view analysis history, API usage, and network participation metrics.

---

## Version History Summary

| Version | Date          | Status   | Theme                         |
| ------- | ------------- | -------- | ----------------------------- |
| 1.0.0   | February 2026 | Released | Initial Release               |
| 1.1.0   | Q2 2026       | Planned  | Production Readiness          |
| 1.2.0   | Q3 2026       | Planned  | Enterprise Features           |
| 2.0.0   | Q1 2027       | Planned  | Revenue Intelligence Platform |

---

## Feedback and Support

We welcome feedback on MarginArc. Please direct product feedback, feature requests, and
bug reports to the following channels:

- **Product feedback:** product@marginarc.com
- **Bug reports:** support@marginarc.com
- **Security issues:** security@marginarc.com (see Security Whitepaper for details)
- **Documentation feedback:** docs@marginarc.com

---

_Copyright 2026 MarginArc. All rights reserved._
